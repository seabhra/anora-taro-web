<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Anora TarÃ´</title>

<style>
body {
  margin: 0;
  padding: 20px;
  font-family: Arial, Helvetica, sans-serif;
  background: #f7f7f7;
  text-align: center;
}

.cards {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}

.card { width: 90px; }

.card img {
  width: 100%;
  border-radius: 10px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.label {
  margin-top: 6px;
  font-size: 13px;
  font-weight: bold;
}

.card-name {
  font-size: 11px;
  color: #6b46c1;
  min-height: 14px;
}

.action-button {
  width: 100%;
  max-width: 320px;
  height: 50px;
  border: none;
  border-radius: 12px;
  font-size: 18px;
  font-weight: bold;
  color: #fff;
  cursor: pointer;
}

.pink { background:#fd98be; }
.blue { background:#64b9ea; }

#status {
  margin-top: 16px;
  font-weight: bold;
  color: #718096;
}

/* ðŸ”„ LOADER CIRCULAR */
#loader {
  display: none;
  margin: 20px auto;
  width: 46px;
  height: 46px;
  border: 5px solid #e2e8f0;
  border-top: 5px solid #6b46c1;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  100% { transform: rotate(360deg); }
}

#aiResponse {
  display: none;
  margin-top: 16px;
  padding: 14px;
  background: #fff;
  border-radius: 12px;
  font-size: 14px;
  text-align: left;
}
</style>
</head>

<body>

<div class="cards">
  <div class="card">
    <img id="card1" src="cards_images/back.jpg">
    <div class="label">Passado</div>
    <div class="card-name" id="name1"></div>
  </div>
  <div class="card">
    <img id="card2" src="cards_images/back.jpg">
    <div class="label">Presente</div>
    <div class="card-name" id="name2"></div>
  </div>
  <div class="card">
    <img id="card3" src="cards_images/back.jpg">
    <div class="label">Futuro</div>
    <div class="card-name" id="name3"></div>
  </div>
</div>

<button id="actionButton" class="action-button pink">
Embaralhar Cartas
</button>

<div id="status">Aguardando sua consulta</div>

<div id="loader"></div>

<div id="aiResponse"></div>

  <script>
const totalCards = 22;
const basePath = 'cards_images/';
const backCard = 'cards_images/back.jpg';

const names = [
const cards = [
 { label:'Louco', file:'louco' },
 { label:'Mago', file:'mago' },
 { label:'Sacerdotisa', file:'sacerdotisa' },
 { label:'Imperatriz', file:'imperatriz' },
 { label:'Imperador', file:'imperador' },
 { label:'Sacerdote', file:'sacerdote' },
 { label:'Amantes', file:'amantes' },
 { label:'Carro', file:'carro' },
 { label:'ForÃ§a', file:'forca' },
 { label:'Eremita', file:'eremita' },
 { label:'Roda', file:'roda' },
 { label:'JustiÃ§a', file:'justica' },
 { label:'Enforcado', file:'enforcado' },
 { label:'Morte', file:'morte' },
 { label:'TemperanÃ§a', file:'temperanca' },
 { label:'Diabo', file:'diabo' },
 { label:'Torre', file:'torre' },
 { label:'Estrela', file:'estrela' },
 { label:'Lua', file:'lua' },
 { label:'Sol', file:'sol' },
 { label:'Julgamento', file:'julgamento' },
 { label:'Mundo', file:'mundo' }
];


let hasReading = false;

// âœ… PEGAR ELEMENTOS CORRETAMENTE
const imgs = [
  document.getElementById('card1'),
  document.getElementById('card2'),
  document.getElementById('card3')
];

const labels = [
  document.getElementById('name1'),
  document.getElementById('name2'),
  document.getElementById('name3')
];

const button = document.getElementById('actionButton');
const status = document.getElementById('status');
const loader = document.getElementById('loader');
const aiBox = document.getElementById('aiResponse');

function shuffle(a) {
 for (let i = a.length - 1; i > 0; i--) {
   const j = Math.floor(Math.random() * (i + 1));
   [a[i], a[j]] = [a[j], a[i]];
 }
 return a;
}

function pad(n) {
 return n.toString().padStart(2,'0');
}

async function newReading() {
 const deck = shuffle([...Array(totalCards).keys()].map(i => i + 1));
 const selected = deck.slice(0, 3);

 selected.forEach((num, i) => {
 imgs[i].src = `${basePath}${pad(num)}_${cards[num-1].file}.jpg`;
labels[i].innerText = cards[num-1].label;
 });

 hasReading = true;
 button.innerText = 'Nova Consulta';
 button.className = 'action-button blue';
 status.textContent = 'Consultandoâ€¦';

 loader.style.display = 'block';
 aiBox.style.display = 'none';

 await callAuroraAPI([
   names[selected[0] - 1],
   names[selected[1] - 1],
   names[selected[2] - 1]
 ]);
}

function resetReading() {
 imgs.forEach(img => img.src = backCard);
 labels.forEach(l => l.innerText = '');
 aiBox.style.display = 'none';
 loader.style.display = 'none';

 hasReading = false;
 button.innerText = 'Embaralhar Cartas';
 button.className = 'action-button pink';
 status.textContent = 'Aguardando sua consulta';
}

async function callAuroraAPI(cards) {
 const prompt = `
Leitura simbÃ³lica de TarÃ´:
Passado: ${cards[0]}
Presente: ${cards[1]}
Futuro: ${cards[2]}
Interprete como reflexÃ£o, sem previsÃµes.
`;

 try {
   const res = await fetch(
     'https://aurora-api-final-2025.vercel.app/api/chat',
     {
       method: 'POST',
       headers: { 'Content-Type': 'application/json' },
       body: JSON.stringify({ message: prompt })
     }
   );
   const data = await res.json();
   aiBox.innerText = data.reply || 'Sem resposta agora.';
 } catch (e) {
   aiBox.innerText = 'Erro ao acessar a reflexÃ£o.';
 }

 loader.style.display = 'none';
 aiBox.style.display = 'block';
 status.textContent = 'Consulta realizada';
}

button.addEventListener('click', () => {
 hasReading ? resetReading() : newReading();
});


  </script>

</body>
</html>


